<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index</title>
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <h1>Customer information</h1>

        <form>
            <div class="row">
                <div class="col-lg-6">
                    <label for="fullName">Full Name</label>
                    <input type="text" id="fullName" class="form-control">
                </div>
                <div class="col-lg-6">
                    <label for="email">Email</label>
                    <input type="email" id="email" class="form-control">
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-lg-6">
                    <label for="phone">Phone</label>
                    <input type="tel" id="phone" class="form-control">
                </div>
                <div class="col-lg-6">
                    <label for="address">Address</label>
                    <input type="text" id="address" class="form-control">
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-lg-3">
                    <button type="button" id="btnCreate" class="btn btn-outline-primary">
                        Create
                    </button>
                </div>
            </div>
        </form>

        <div>
            <table class="table table-hover" id="tbCustomer">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Full Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Address</th>
                        <th>Balance</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- <tr>
                        <td>1</td>
                        <td>NVA</td>
                        <td>nva@gmail.com</td>
                        <td>2345</td>
                        <td>28 NTP</td>
                        <td>0</td>
                        <td>
                            <button type="button" class="btn btn-ouline-secondary">Edit</button>
                        </td>
                    </tr> -->
                </tbody>
            </table>
        </div>

    </div>

    <script src="/assets/js/jquery-3.6.0.min.js"></script>
    <script src="/assets/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/app.js"></script>

    <script>

        let customers = [];

        let customer = new Customer();

        customer.id = 1;
        customer.fullName = 'NVA';
        customer.email = 'nva@gmail.com';
        customer.phone = '2345';
        customer.address = '28 NTP';
        customers.push(customer);

        let id = 1;

        function loadCustomers() {

            $.ajax({
                "type": "GET",
                "url": "http://localhost:3000/customers?deleted=0"
            })
            .done((data) => {
                $.each(data, (i, item) => {
                    let str = `
                        <tr>
                            <td>${item.id}</td>
                            <td>${item.fullName}</td>
                            <td>${item.email}</td>
                            <td>${item.phone}</td>
                            <td>${item.address}</td>
                            <td>${item.balance}</td>
                            <td>
                                <button type="button" class="btn btn-ouline-secondary">Edit</button>
                            </td>
                        </tr>
                    `;

                    $('#tbCustomer tbody').prepend(str);
                });
            })
        }

        loadCustomers();

        $('#btnCreate').on('click', function () {
            let fullName = $('#fullName').val();
            let email = $('#email').val();
            let phone = $('#phone').val();
            let address = $('#address').val();

            delete customer.id;
            customer.fullName = fullName;
            customer.email = email;
            customer.phone = phone;
            customer.address = address;

            $.ajax({
                "type": "POST",
                "url": "http://localhost:3000/customers",
                "data": customer
            })
            .done((item) => {

                let str = `
                    <tr>
                        <td>${item.id}</td>
                        <td>${item.fullName}</td>
                        <td>${item.email}</td>
                        <td>${item.phone}</td>
                        <td>${item.address}</td>
                        <td>${item.balance}</td>
                        <td>
                            <button type="button" class="btn btn-ouline-secondary">Edit</button>
                        </td>
                    </tr>
                `;

                $('#tbCustomer tbody').prepend(str);
            })

            // let str = `
            //     <tr>
            //         <td>${id}</td>
            //         <td>${fullName}</td>
            //         <td>${email}</td>
            //         <td>${phone}</td>
            //         <td>${address}</td>
            //         <td>${balance}</td>
            //         <td>
            //             <button type="button" class="btn btn-ouline-secondary">Edit</button>
            //         </td>
            //     </tr>
            // `;

            // $('#tbCustomer tbody').prepend(str);

            // id++;

        });
    </script>
</body>
</html>